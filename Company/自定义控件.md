# 自定义控件

##方法一
### 基本步骤 
* 创建自定义控件的布局文件
* 自定义类绑定布局继承Layout

### 实例
* 布局文件
```xml
<?xml version="1.0" encoding="utf-8"?>
<LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"
    android:layout_width="fill_parent"
    android:layout_height="wrap_content"
    android:orientation="vertical" >

    <LinearLayout
        android:id="@+id/lay_myedittext_main"
        android:layout_width="fill_parent"
        android:layout_height="wrap_content"
        android:minHeight="50dp"
        android:layout_marginLeft="15dp"
        android:orientation="vertical" >

        <RelativeLayout
            android:layout_width="fill_parent"
            android:layout_height="wrap_content"
            android:layout_marginTop="4dp"
            android:layout_gravity="center_vertical"
            android:gravity="center_vertical" >

            <TextView
                android:id="@+id/tv_myedittext_hint"
                android:layout_width="wrap_content"
                android:layout_height="wrap_content"
                android:gravity="center_vertical"
                android:text="hint"
                android:textColor="#999999"
                android:textSize="11dp" />


    <ImageView
                android:id="@+id/iv_myedittext_mustinput"
                android:layout_width="wrap_content"
                android:layout_height="wrap_content"
                android:layout_alignParentRight="true"
                android:layout_marginRight="25dp"
                android:gravity="center_vertical"
                android:src="@drawable/mustinput_icon" />
        </RelativeLayout>

        <RelativeLayout
            android:layout_width="fill_parent"
            android:layout_height="wrap_content"
            android:layout_marginTop="4dp"
            android:layout_gravity="center_vertical"
            android:gravity="center_vertical" >

            <EditText
                android:id="@+id/et_myedittext"
                android:layout_width="fill_parent"
                android:layout_height="wrap_content"
                android:background="@null"
                android:gravity="center_vertical"
                android:hint="@string/text_myedittextview_hint"
                android:textColor="#333333"
                android:textColorHint="#999999"
                android:textSize="17dp"
                android:layout_toLeftOf="@+id/iv_myedittext_lunch"/>

            <ImageView
                android:id="@+id/iv_myedittext_lunch"
                android:layout_width="wrap_content"
                android:layout_height="wrap_content"
                android:layout_alignParentRight="true"
                android:layout_marginRight="10dp"
                android:gravity="center_vertical"
                android:visibility="invisible"
                android:src="@drawable/lunch_icon_normal" />
        </RelativeLayout>
    </LinearLayout>

    <View
        android:layout_width="fill_parent"
        android:id="@+id/v_bottomline"
        android:layout_height="1dp"
        android:layout_marginLeft="15dp"
        android:background="#999999" />

</LinearLayout>
```
* 实现类
```java
package com.zhidream.grxx.view;

import com.zhidream.grxx.activity.R;
import com.zhidream.grxx.resource.NameAndValue;

import android.content.Context;
import android.text.Editable;
import android.text.TextWatcher;
import android.text.method.DigitsKeyListener;
import android.util.AttributeSet;
import android.view.KeyEvent;
import android.view.LayoutInflater;
import android.view.View;
import android.widget.EditText;
import android.widget.ImageView;
import android.widget.LinearLayout;
import android.widget.TextView;
import android.widget.TextView.OnEditorActionListener;

/**
 * 自定义输入项目控件
 * 
 * @author wangkai 2015年3月12日
 */
public class MyEditTextView extends LinearLayout {

	private TextView tv_hint;
	private ImageView iv_mustinput;
	private EditText et_input;
	private ImageView iv_lunch;
	private edittextChangeListener listener;
	private EditText checkEditText;

	private View bottomline;

	public MyEditTextView(Context context) {
		this(context, null);
	}

	public MyEditTextView(Context context, AttributeSet attrs) {
		super(context, attrs);
		LayoutInflater.from(context).inflate(R.layout.myedittextview_lay, this,
				true);
		tv_hint = (TextView) findViewById(R.id.tv_myedittext_hint);
		iv_mustinput = (ImageView) findViewById(R.id.iv_myedittext_mustinput);
		iv_lunch = (ImageView) findViewById(R.id.iv_myedittext_lunch);
		et_input = (EditText) findViewById(R.id.et_myedittext);
		et_input.setOnEditorActionListener(new OnEditorActionListener() {
			@Override
			public boolean onEditorAction(TextView v, int actionId,
					KeyEvent event) {
				return (event.getKeyCode() == KeyEvent.KEYCODE_ENTER);
			}
		});
		tv_hint.setVisibility(View.INVISIBLE);
		et_input.setOnFocusChangeListener(new OnFocusChangeListener() {
			@Override
			public void onFocusChange(View v, boolean hasFocus) {
				if (hasFocus) {
					tv_hint.setVisibility(View.VISIBLE);
					tv_hint.setTextColor(0xff2d68a5);
				} else {
					if (et_input.getText().toString().equals("")) {
						tv_hint.setVisibility(View.INVISIBLE);
					}
					tv_hint.setTextColor(0xff999999);
				}
			}
		});

		bottomline = findViewById(R.id.v_bottomline);
	}

	public void setBottomlineShow(boolean needShow)
	{
		if (!needShow)
		{
			bottomline.setVisibility(View.INVISIBLE);
		}
	}

	/**
	 * 设置提示语句
	 * 
	 * @param hint
	 */
	public void setTextHint(String hint) {
		tv_hint.setText(hint);
		et_input.setHint(hint);
	}

	/**
	 * 获取输入内容
	 * 
	 * @return
	 */
	public String getEditTextString() {
		return et_input.getText().toString();
	}

	/**
	 * 设置必须填写是否可见
	 * 
	 * @param show
	 */
	public void setMustInputIsshow(boolean show) {
		if (show) {
			iv_mustinput.setVisibility(View.VISIBLE);
		} else {
			iv_mustinput.setVisibility(View.INVISIBLE);
		}
	}

	/**
	 * 设置添加按钮图片
	 * 
	 * @param res
	 */
	public void setLunchImage(int res) {
		iv_lunch.setVisibility(View.VISIBLE);
		iv_lunch.setImageResource(res);
	}

	/**
	 * 设置输入框是否可输入
	 * 
	 * @param caninput
	 */
	public void setEdittextIsInput(boolean caninput) {
		if (caninput) {
			et_input.setEnabled(true);
			et_input.setTextColor(0xff333333);
			et_input.setHintTextColor(0xff999999);
		} else {
			et_input.setEnabled(false);
			et_input.setText("");
			et_input.setTextColor(0xffc8c8c8);
			et_input.setHintTextColor(0xffc8c8c8);
			tv_hint.setVisibility(View.INVISIBLE);
		}
	}

	public void setFalse(boolean isclick) {
		if (isclick) {
			et_input.setEnabled(true);
		} else {
			et_input.setEnabled(false);
		}
	}

	/**
	 * 获取的到向右的箭头图标，用户更换加号图标
	 * 
	 * @return
	 */
	public ImageView getLunchIv() {
		return iv_lunch;
	}

	/**
	 * 设置输入框只能输入数字
	 */
	public void setNumOnly() {
		et_input.setKeyListener(new DigitsKeyListener(false, true));
	}

	/**
	 * 设置输入框只能输入数字
	 */
	public void setTextShow(String str) {
		if (str != null && (str.equals(NameAndValue.TEXT_NULL))) {// 待完善数据上传数据库，必填项如果为null，避免数据库存不上，填写为”NULL“，读取的时候做特殊
			str = "";
		}
		et_input.setText(str);
		tv_hint.setVisibility(View.VISIBLE);
	}
	
	public void setTextShow_menpaihao(String str) {
		et_input.setText(str);
		tv_hint.setVisibility(View.VISIBLE);
	}

	private TextWatcher textWatcher = new TextWatcher() {

		@Override
		public void afterTextChanged(Editable s) {
		}

		@Override
		public void beforeTextChanged(CharSequence s, int start, int count,
				int after) {
		}

		@Override
		public void onTextChanged(CharSequence s, int start, int before,
				int count) {
			// listener.editTextStr(et_search.getText().toString());
			if (listener != null) {
				listener.changeEditListener(checkEditText.getText().toString());
			}
		}
	};

	/**
	 * 设置根据输入框输入的数字动态添加布局，用于组合控件
	 * 
	 * @param listener
	 */
	public void setChangeListener(edittextChangeListener listener) {
		this.listener = listener;
	}

	/**
	 * 设置根据哪个控件输入的内容经行动态添加，并且对该输入框进行内容改变监听
	 * 
	 * @param editText
	 */
	public void setCheckEditText(EditText editText) {
		this.checkEditText = editText;
		editText.addTextChangedListener(textWatcher);
	}

	public void setCheckEditText() {
		this.checkEditText = et_input;
		et_input.addTextChangedListener(textWatcher);
	}

	/**
	 * 获取当前的输入框，用于当动态添加是获取当前输入框的内用
	 * 
	 * @return
	 */
	public EditText getThisEt() {
		return et_input;
	}

	public interface edittextChangeListener {
		void changeEditListener(String str);
	}

}

```
